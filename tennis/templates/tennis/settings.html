{# tennis/templates/tennis/settings.html #}
{% extends "tennis/base.html" %}
{% load static %}

{% block title %}ã‚¯ãƒ©ãƒ–è¨­å®š - å¹¹äº‹ç”¨{% endblock %}

{% block extra_head %}
<link rel="stylesheet" href="{% static 'tennis/calendar.css' %}">
<script src="{% static 'tennis/calendar.js' %}" defer></script>
{% endblock %}

{% block content %}
<h2>ã‚¯ãƒ©ãƒ–è¨­å®šï¼ˆå¹¹äº‹ç”¨ï¼‰</h2>
<p class="settings-desc">
    æ–°ã—ãã‚¯ãƒ©ãƒ–ã‚’ä½œæˆã—ãŸã‚‰ã€ã¾ãšã“ã®ãƒšãƒ¼ã‚¸ã§
    <strong>ç·´ç¿’æ—¥ã®è¨­å®š</strong> ã¨ <strong>å‡ºå¸­è¡¨ã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ</strong> ã‚’æ±ºã‚ã¦ãã ã•ã„ã€‚
</p>

<hr>

<h3>â‘  ç·´ç¿’æ—¥ã®è¨­å®šï¼ˆã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ï¼‰</h3>

<div class="calendar-nav">
    <a href="{% url 'tennis:settings' %}?year={{ prev_year }}&month={{ prev_month }}">Â« å‰ã®æœˆ</a>
    <span class="calendar-title">{{ year }}å¹´ {{ month }}æœˆ</span>
    <a href="{% url 'tennis:settings' %}?year={{ next_year }}&month={{ next_month }}">æ¬¡ã®æœˆ Â»</a>
</div>

<table class="practice-calendar">
    <thead>
        <tr>
            <th>æœˆ</th>
            <th>ç«</th>
            <th>æ°´</th>
            <th>æœ¨</th>
            <th>é‡‘</th>
            <th class="weekend">åœŸ</th>
            <th class="weekend">æ—¥</th>
        </tr>
    </thead>
    <tbody>
    {% for week in month_weeks %}
        <tr>
        {% for cell in week %}
            {% if cell.is_current_month %}
                <td class="day-cell{% if cell.date == today %} today{% endif %}">
                    <div class="day-number">{{ cell.date.day }}</div>

                    {# ã“ã®æ—¥ã®ç·´ç¿’ã‚¤ãƒ™ãƒ³ãƒˆ #}
                    {% for ev in cell.events %}
                    <div class="event-card">
                        <div class="event-title">
                            {# å¹¹äº‹ç”¨ãƒšãƒ¼ã‚¸ã¸ã®ãƒªãƒ³ã‚¯ #}
                            <a href="{% url 'tennis:event_admin' ev.public_token ev.admin_token %}">
                                {{ ev.title }}
                            </a>
                        </div>

                        <div class="event-flags"
                             data-event-id="{{ ev.id }}"
                             data-add-flag-url="{% url 'tennis:add_flag' %}"
                             data-delete-flag-url="{% url 'tennis:delete_flag' %}">
                            {% with ev_flags=flags_by_event.ev.id %}
                            {% endwith %}
                            {% if flags_by_event.ev.id %}
                                {% for flag in flags_by_event.ev.id %}
                                    <span class="flag-chip">{{ flag.name }}</span>
                                {% endfor %}
                            {% else %}
                                <span class="flag-chip flag-chip-empty">ãƒ•ãƒ©ã‚°ãªã—</span>
                            {% endif %}
                        </div>

                        <div class="event-flag-actions">
                            <button type="button"
                                    class="flag-add-btn-sm"
                                    data-event-id="{{ ev.id }}">
                                ï¼‹ãƒ•ãƒ©ã‚°
                            </button>
                            <button type="button"
                                    class="flag-delete-btn-sm"
                                    data-event-id="{{ ev.id }}">
                                ï¼ãƒ•ãƒ©ã‚°
                            </button>
                        </div>
                    </div>
                    {% endfor %}
                </td>
            {% else %}
                <td class="day-cell other-month"></td>
            {% endif %}
        {% endfor %}
        </tr>
    {% endfor %}
    </tbody>
</table>

<hr style="margin: 24px 0;">

<h3>â‘¡ å‡ºå¸­è¡¨ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆè¨­å®šï¼ˆã²ãªå‹ï¼‰</h3>
<p class="settings-desc">
    ã“ã“ã§ã¯ã€å‡ºå¸­è¡¨ã®åŸºæœ¬ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ãƒ•ãƒ©ã‚°ã‚„è¡¨ç¤ºé †ãªã©ï¼‰ã‚’æ±ºã‚ã¾ã™ã€‚<br>
    â€» ç¾æ™‚ç‚¹ã§ã¯æ ã®ã¿ã€‚å¾Œæ—¥ã€å®Ÿéš›ã«ä¿å­˜ãƒ»åæ˜ ã™ã‚‹é …ç›®ã‚’è¿½åŠ ã—ã¦ã„ãã¾ã™ã€‚
</p>

<div class="attendance-format-box">
    <p>ä¾‹ï¼‰ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ç”¨æ„ã™ã‚‹ãƒ•ãƒ©ã‚°ï¼š</p>
    <ul>
        <li>ğŸ¾ ãƒœãƒ¼ãƒ«ä¿‚</li>
        <li>ğŸ§º ã‹ã”ä¿‚</li>
        <li>ğŸ§´ ã‚³ãƒ¼ãƒˆæ•´å‚™</li>
    </ul>

    {# ã“ã“ã«å°†æ¥ãƒ•ã‚©ãƒ¼ãƒ ã‚’è¿½åŠ ã™ã‚‹æƒ³å®š #}
    {# <form method="post"> ... </form> #}
</div>

{% endblock %}
